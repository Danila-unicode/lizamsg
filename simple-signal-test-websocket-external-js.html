<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>–í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ - LizaApp</title>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- –®–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <div class="app-header">
        <div class="logo">
            <i class="fas fa-phone"></i> LizaApp
        </div>
        <div class="user-info" id="headerUserInfo" style="display: none;">
            <div class="user-avatar" id="userAvatar" onclick="openProfile()">
                <i class="fas fa-user-circle"></i>
            </div>
            <span id="currentUserId" onclick="openProfile()" style="cursor: pointer;"></span>
            <button class="logout-btn" onclick="resetUser()" style="display: inline-block;">–í—ã–π—Ç–∏</button>
        </div>
    </div>

    <div class="container main-container">
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar left-sidebar">
            <div class="tabs navigation-tabs">
                <div class="tab active" onclick="switchTab('friends')"><i class="fas fa-users"></i> –î—Ä—É–∑—å—è</div>
                <div class="tab" onclick="switchTab('requests')"><i class="fas fa-inbox"></i> –ó–∞–ø—Ä–æ—Å—ã</div>
                <div class="tab" onclick="switchTab('invitations')"><i class="fas fa-paper-plane"></i> –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</div>
            </div>
            <div class="tab-content sidebar-content">
                <!-- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
                <div class="search-section user-search">
                    <h3><i class="fas fa-search"></i> –ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</h3>
                    <div class="search-input-container" style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
                        <input type="text" id="searchUsername" placeholder="+79991234567" style="flex: 1; padding: 8px 12px; border: 1px solid #ddd; border-radius: 5px;" autocomplete="new-password" autocapitalize="off" autocorrect="off" spellcheck="false" readonly onfocus="this.removeAttribute('readonly')">
                        <button onclick="selectFromContacts()" class="btn-secondary contacts-btn" style="border: 1px solid #007bff; background: #007bff; color: white; border-radius: 5px; cursor: pointer;" title="–í—ã–±—Ä–∞—Ç—å –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤">
                            <i class="fas fa-address-book"></i>
                        </button>
                        <button onclick="searchUser()" class="btn-primary search-btn" style="border: 1px solid #28a745; background: #28a745; color: white; border-radius: 5px; cursor: pointer;" title="–ù–∞–π—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <div id="searchResults"></div>
                </div>
                
                <!-- –¢–∞–± –î—Ä—É–∑—å—è -->
                <div id="friendsTab" class="tab-panel friends-panel">
                    <h3>–ú–æ–∏ –¥—Ä—É–∑—å—è</h3>
                    
                    <!-- –ü–æ–∏—Å–∫ –ø–æ –¥—Ä—É–∑—å—è–º -->
                    <div class="friends-search-container">
                        <input type="text" id="friendsSearchInput" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏–ª–∏ –Ω–æ–º–µ—Ä—É..." class="friends-search-input" oninput="filterFriends()">
                    </div>
                    
                    <div id="friendsList" class="friends-list"></div>
                </div>
                
                <!-- –¢–∞–± –ó–∞–ø—Ä–æ—Å—ã -->
                <div id="requestsTab" class="tab-panel requests-panel" style="display: none;">
                    <h3>–í—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã</h3>
                    <div id="requestsList" class="requests-list"></div>
                </div>
                
                <!-- –¢–∞–± –ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                <div id="invitationsTab" class="tab-panel invitations-panel" style="display: none;">
                    <h3>–ò—Å—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã</h3>
                    <div id="sentRequestsList" class="sent-requests-list"></div>
                </div>
            </div>
        </div>
            
        <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
        <div class="main-content right-content">
            <div class="titlemain">
            <h1><i class="fas fa-phone"></i> –í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏ LizaApp</h1>
            <p><strong>–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:</strong> –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ —Å–≤–æ–∏–º –ª–æ–≥–∏–Ω–æ–º –∏ –ø–æ–∑–≤–æ–Ω–∏—Ç–µ –¥—Ä—É–≥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é. –í—Ç–æ—Ä–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –æ—Ç–∫—Ä—ã—Ç—å —ç—Ç—É –∂–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É –Ω–∞ –¥—Ä—É–≥–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.</p>
            <button onclick="window.open('https://lizaapp.ru/register.php', '_blank')" style="background: #4CAF50; color: white; padding: 10px 20px; margin: 10px 0; border: none; border-radius: 5px; cursor: pointer;">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</button>
                </div>
            
        <!-- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é -->
        <div class="usage-instructions" id="usageInstructions">
            
            <div class="quick-start">
                <h3><i class="fas fa-play-circle"></i> –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</h3>
                <div class="start-steps">
                    <div class="start-step">
                        <div class="step-number">1</div>
                        <div class="step-text">
                            <h4>–ù–∞–π–¥–∏—Ç–µ –¥—Ä—É–∑–µ–π</h4>
                            <p>–ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</p>
                        </div>
                </div>
                    <div class="start-step">
                        <div class="step-number">2</div>
                        <div class="step-text">
                            <h4>–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å</h4>
                            <p>–î–æ–±–∞–≤—å—Ç–µ –≤ –¥—Ä—É–∑—å—è</p>
                </div>
                        </div>
                    <div class="start-step">
                        <div class="step-number">3</div>
                        <div class="step-text">
                            <h4>–î–æ–∂–¥–∏—Ç–µ—Å—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è</h4>
                            <p>–ü—Ä–∏–Ω—è—Ç–∏–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</p>
                        </div>
                    </div>
                    <div class="start-step">
                        <div class="step-number">4</div>
                        <div class="step-text">
                            <h4>–ù–∞—á–Ω–∏—Ç–µ –æ–±—â–µ–Ω–∏–µ</h4>
                            <p>–°–æ–æ–±—â–µ–Ω–∏—è –∏ –∑–≤–æ–Ω–∫–∏</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="features-showcase">
                <h3><i class="fas fa-star"></i> –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</h3>
                <div class="features-grid">
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-comment-dots"></i>
                        </div>
                        <div class="feature-content">
                            <h4>–°–æ–æ–±—â–µ–Ω–∏—è</h4>
                            <p>–ë—ã—Å—Ç—Ä–∞—è –ø–µ—Ä–µ–ø–∏—Å–∫–∞ —Å –¥—Ä—É–∑—å—è–º–∏</p>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="feature-content">
                            <h4>–ê—É–¥–∏–æ–∑–≤–æ–Ω–∫–∏</h4>
                            <p>–ì–æ–ª–æ—Å–æ–≤—ã–µ –∑–≤–æ–Ω–∫–∏ –≤—ã—Å–æ–∫–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞</p>
                        </div>
                    </div>
                    <div class="feature-card">
                        <div class="feature-icon">
                            <i class="fas fa-video"></i>
                        </div>
                        <div class="feature-content">
                            <h4>–í–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏</h4>
                            <p>–í–∏–¥–µ–æ –æ–±—â–µ–Ω–∏–µ –≤ HD –∫–∞—á–µ—Å—Ç–≤–µ</p>
                </div>
                        </div>
                        </div>
                    </div>
                    
            <div class="security-info">
                <div class="security-icon">
                    <i class="fas fa-shield-alt"></i>
                </div>
                <div class="security-content">
                    <h4>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</h4>
                    <p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã, –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∞</p>
                    </div>
                </div>
            </div>
            
            <!-- –û–∫–Ω–æ —á–∞—Ç–∞ –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ -->
            <div id="chatContainer" class="chat-container" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 1000;">
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ -->
                <div style="background: #2c3e50; color: white; padding: 20px; border-radius: 0; display: flex; justify-content: space-between; align-items: center;">
                    <div>
                        <h3 style="margin: 0; font-size: 24px; font-weight: 600;">üí¨ –ß–∞—Ç —Å <span id="chatFriendName">–î—Ä—É–≥–æ–º</span></h3>
                        <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 14px;">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</p>
                    </div>
                    <div style="display: flex; gap: 10px; align-items: center;">
                    <button onclick="callFriendFromChat()" class="btn-primary btn-small" id="chatCallBtn" style="padding: 8px 12px; font-size: 12px;"><i class="fas fa-video"></i></button>
                    <button onclick="callFriendAudioFromChat()" class="btn-secondary btn-small" id="chatAudioCallBtn" style="padding: 8px 12px; font-size: 12px;"><i class="fas fa-phone"></i></button>
                        <button onclick="closeChat()" style="background: #e74c3c; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold;">‚úï</button>
                    </div>
                </div>
                
                <!-- –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
            <div style="flex: 1; padding: 5px; display: flex; flex-direction: column; background: #f8f9fa; height: calc(100% - 140px);">
                    <!-- –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è -->
                    <div id="chatStatus" style="padding: 10px 20px; background: #fff3cd; color: #856404; border-bottom: 1px solid #ffeaa7; font-size: 14px;">
                        –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —á–∞—Ç-—Å–µ—Ä–≤–µ—Ä—É...
                    </div>
                    
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è —á–∞—Ç–∞ -->
                    <div id="chatMessages" style="flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9; border-radius: 8px; margin: 10px 0;">
                        <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                    
                    
                    <!-- –ü–∞–Ω–µ–ª—å —ç–º–æ–¥–∑–∏ -->
                    <div id="chatEmojiPanel" style="display: none; padding: 10px; background: #e3f2fd; border-top: 1px solid #ddd; border-radius: 8px 8px 0 0;">
                        <div style="display: grid; grid-template-columns: repeat(10, 1fr); gap: 8px; max-height: 200px; overflow-y: auto;">
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üòÄ')">üòÄ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üòÇ')">üòÇ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üòç')">üòç</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('ü§î')">ü§î</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üëç')">üëç</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üëé')">üëé</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('‚ù§Ô∏è')">‚ù§Ô∏è</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéâ')">üéâ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üî•')">üî•</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üíØ')">üíØ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üöÄ')">üöÄ</span>
                        <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üí™')">üí™</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéä')">üéä</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéà')">üéà</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéÅ')">üéÅ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéÇ')">üéÇ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üç∞')">üç∞</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('ü•≥')">ü•≥</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéÜ')">üéÜ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéá')">üéá</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('‚ú®')">‚ú®</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üåü')">üåü</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üí´')">üí´</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('‚ö°')">‚ö°</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üíé')">üíé</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üéØ')">üéØ</span>
                            <span style="padding: 5px; cursor: pointer; border-radius: 5px; text-align: center; font-size: 18px;" onclick="sendChatEmoji('üèÜ')">üèÜ</span>
                        </div>
                    </div>
                    
                    <!-- –ü–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ —Å–æ–æ–±—â–µ–Ω–∏—è (–æ–±—ã—á–Ω–∞—è) -->
                    <div id="chatInputPanel" style="display: flex; padding: 5px; background: white; border-top: 1px solid #ddd; border-radius: 0 0 8px 8px;">
                        <input type="text" id="chatMessageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ... (—ç–º–æ–¥–∑–∏ –≤—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç)" style="flex: 1; padding: 12px 16px; border: 1px solid #ddd; border-radius: 20px; outline: none; font-size: 14px;" onkeypress="handleChatKeyPress(event)" autocomplete="off">
                        <button onclick="sendChatMessage()" style="background: #4CAF50; color: white; border: none; padding: 12px 20px; border-radius: 20px; margin-left: 10px; cursor: pointer; font-size: 14px;"><i class="fas fa-paper-plane"></i></button>
                        <button onclick="toggleChatEmojiPanel()" style="background: #2196F3; color: white; border: none; padding: 12px 15px; border-radius: 20px; margin-left: 10px; cursor: pointer; font-size: 14px;"><i class="far fa-smile"></i></button>
                    </div>
                    
                    <!-- –ú–µ–Ω—é –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π -->
                    <div id="selectedMessagesMenu" class="selected-messages-menu" style="display: none; padding: 5px; background: white; border-top: 1px solid #ddd; border-radius: 0 0 8px 8px;">
                        <div class="selected-count">
                            <span id="selectedCount">0</span> —Å–æ–æ–±—â–µ–Ω–∏–π
                        </div>
                        <button class="menu-trigger" onclick="toggleSelectionMenu()">
                            <i class="fas fa-ellipsis-v"></i>
                        </button>
                        <div class="selection-menu" id="selectionMenu">
                            <div class="menu-item" onclick="copySelectedMessages()">
                                <i class="fas fa-copy"></i>
                                –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                            </div>
                            <div class="menu-item resend" onclick="resendSelectedMessages()">
                                <i class="fas fa-redo"></i>
                                –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
                            </div>
                            <div class="menu-item delete" onclick="deleteSelectedMessages()">
                                <i class="fas fa-trash"></i>
                                –£–¥–∞–ª–∏—Ç—å
                            </div>
                        </div>
                    </div>
            </div>
        </div>
        <div class="user-section profile-section user-profile">
            <h2></h2>
            <div id="loginSection" class="login-form" style="display: none;">
                <input type="text" id="userId" value="" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –ª–æ–≥–∏–Ω" autocomplete="off">
                <input type="password" id="userPassword" value="" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" style="display: none;">
                <button onclick="showPasswordField(event)">–í–æ–π—Ç–∏</button>
            </div>
            
            <div id="userInfo" class="user-info-panel" style="display: none;">
                <div id="userStatus" class="status disconnected">–û—Ç–∫–ª—é—á–µ–Ω</div>
                <p><strong>–õ–æ–≥–∏–Ω:</strong> <span id="profileCurrentUserId"></span></p>
                <input type="text" id="targetUserId" value="" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–≥–∏–Ω —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–∞" class="old-functionality" autocomplete="off">
                <button onclick="startCall()" id="startCallBtn" disabled style="background: #4CAF50; color: white; display: none;" class="old-functionality"><i class="fas fa-phone"></i> –ü–æ–∑–≤–æ–Ω–∏—Ç—å</button>
                <button onclick="disconnectCall()" id="disconnectBtn" disabled style="background: #f44336; color: white; display: none;" class="old-functionality">üîå –†–∞–∑–æ—Ä–≤–∞—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ</button>
                <button onclick="logout()" style="background: #ff9800; color: white;"><i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏</button>
            </div>
        
            <!-- –û–∫–Ω–æ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∞ –≤ –ø—Ä–∞–≤–æ–π —á–∞—Å—Ç–∏ -->
            <div id="videoCallContainer" class="video-call-container" style="display: none; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 2000;">
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
                <div style="background: #f8f9fa; color: white; padding: 0px; border-radius: 0;">
                   */ <h3 style="margin: 0; font-size: 1px; font-weight: 600;"><i class="fas fa-video"></i>–í–∏–¥–µ–æ–∑–≤–æ–Ω–æ–∫</h3>
                    <p style="margin: 0px 0 0 0; opacity: 0.9; font-size: 1px;">–°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ</p> */
                </div>
                
                <!-- –û–±–ª–∞—Å—Ç—å –≤–∏–¥–µ–æ -->
                <div style="flex: 1; padding: 30px; */ display: flex; */ flex-direction: column; gap: 30px; justify-content: center; align-items: center; background: #f8f9fa; height: calc(100% - 140px);">
                    <!-- –í–∏–¥–µ–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä -->
                    <div style="display: flex; gap: 30px; justify-content: center; align-items: center;">
                        <!-- –õ–æ–∫–∞–ª—å–Ω–æ–µ –≤–∏–¥–µ–æ -->
                        <div style="position: relative;">
                            <video id="localVideo" autoplay muted style="width: 400px; height: 400px; background: #000; border-radius: 10px; object-fit: cover; box-shadow: 0 4px 12px rgba(0,0,0,0.3);" volume="0"></video>
                            <div style="position: absolute; bottom: 15px; left: 15px; background: #2c3e50; color: white; padding: 8px 15px; border-radius: 4px; font-size: 14px; font-weight: 500;">–í—ã</div>
                        </div>
                        
                        <!-- –£–¥–∞–ª–µ–Ω–Ω–æ–µ –≤–∏–¥–µ–æ -->
                        <div style="position: relative;">
                            <video id="remoteVideo" autoplay style="width: 400px; height: 400px; background: #000; border-radius: 10px; object-fit: cover; box-shadow: 0 4px 12px rgba(0,0,0,0.3);"></video>
                            <div style="position: absolute; bottom: 15px; left: 15px; background: #2c3e50; color: white; padding: 8px 15px; border-radius: 4px; font-size: 14px; font-weight: 500;">–°–æ–±–µ—Å–µ–¥–Ω–∏–∫</div>
                        </div>
                    </div>
                    
                    <!-- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–≤–æ–Ω–∫–æ–º -->
                    <div style="text-align: center; margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
                        <button onclick="toggleVideoMicrophone()" id="videoMicrophoneBtn" class="control-btn microphone-btn">
                            <i class="fas fa-microphone"></i>
                        </button>
                        <button onclick="toggleVideoCamera()" id="videoCameraBtn" class="control-btn camera-btn">
                            <i class="fas fa-video"></i>
                        </button>
                        <button onclick="switchCamera()" class="control-btn switch-camera-btn">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                        <button onclick="endCall()" class="control-btn end-call-btn">
                            <i class="fas fa-phone"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- –û–∫–Ω–æ –∞—É–¥–∏–æ–∑–≤–æ–Ω–∫–∞ -->
            <div id="audioCallContainer" class="audio-call-container" style="display: none;">
                <div class="audio-call-window">
                    <div class="audio-call-header">
                        <div class="caller-info">
                            <div id="audioCallerAvatar" class="caller-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="caller-details">
                                <div class="caller-name" id="audioCallerName">–ò–º—è –∑–≤–æ–Ω—è—â–µ–≥–æ</div>
                                <div class="call-timer" id="audioCallTimer">00:00</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="audio-call-content">
                        <div class="audio-indicator">
                            <div class="audio-waves">
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                                <div class="wave"></div>
                            </div>
                        </div>
                        
                        <div class="audio-controls">
                            <button onclick="toggleMicrophone()" id="audioMicrophoneBtn" class="control-btn microphone-btn">
                                <i class="fas fa-microphone"></i>
                            </button>
                            <button onclick="toggleSpeakerphone()" id="speakerphoneBtn" class="control-btn speakerphone-btn">
                                <i class="fas fa-volume-up"></i>
                            </button>
                            <button onclick="endCall()" class="control-btn end-call-btn">
                                <i class="fas fa-phone"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            
            <div id="log" class="log"></div>
        </div>
        
        <!-- –û–∫–Ω–æ –≤—Ö–æ–¥—è—â–µ–≥–æ –∑–≤–æ–Ω–∫–∞ -->
        <div id="incomingCallModal" class="incoming-call-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 10000; justify-content: center; align-items: center;">
            <div class="incoming-call-container">
                <!-- –ò–∫–æ–Ω–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ —Å –≤–æ–ª–Ω–∞–º–∏ -->
                <div class="call-icon-container">
                    <i class="fas fa-phone call-icon"></i>
                </div>
                
                <!-- –°—Ç–∞—Ç—É—Å –∑–≤–æ–Ω–∫–∞ -->
                <div class="call-status">–í—Ö–æ–¥—è—â–∏–π –≤—ã–∑–æ–≤...</div>
                
                <!-- –¢–∏–ø –∑–≤–æ–Ω–∫–∞ -->
                <div id="callTypeText" class="call-type">–¢–∏–ø –∑–≤–æ–Ω–∫–∞</div>
                
                <!-- –ê–≤–∞—Ç–∞—Ä –∑–≤–æ–Ω—è—â–µ–≥–æ -->
                <div class="caller-avatar-container">
                    <div id="callerAvatarPlaceholder" class="caller-avatar-placeholder">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
                
                <!-- –ò–º—è –∑–≤–æ–Ω—è—â–µ–≥–æ -->
                <div class="caller-name" id="callerName">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                
                <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                <div class="call-actions">
                    <button onclick="acceptIncomingCall()" class="accept-btn">
                        <i class="fas fa-phone"></i>
                        <span>–ü—Ä–∏–Ω—è—Ç—å</span>
                    </button>
                    <button onclick="rejectIncomingCall()" class="decline-btn">
                        <i class="fas fa-phone-slash"></i>
                        <span>–û—Ç–∫–ª–æ–Ω–∏—Ç—å</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- –û–∫–Ω–æ —á–∞—Ç–∞ -->
        <div id="chatModal" class="chat-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1001; justify-content: center; align-items: center;">
            <div style="background: white; width: 400px; height: 500px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); display: flex; flex-direction: column;">
                <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ -->
                <div style="background: #2196F3; color: white; padding: 15px; border-radius: 15px 15px 0 0; display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin: 0;">üí¨ –ß–∞—Ç —Å <span id="chatFriendName"></span></h3>
                    <button onclick="closeChat()" style="background: none; border: none; color: white; font-size: 20px; cursor: pointer;">‚úï</button>
            </div>
            
                <!-- –û–±–ª–∞—Å—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–π -->
                <div id="chatMessages" style="flex: 1; padding: 15px; overflow-y: auto; background: #f9f9f9;">
                    <!-- –°–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –∑–¥–µ—Å—å -->
        </div>
        
                <!-- –ü–∞–Ω–µ–ª—å —ç–º–æ–¥–∑–∏ -->
                <div id="emojiPanel" style="display: none; padding: 10px; background: #e3f2fd; border-top: 1px solid #ddd;">
                    <div style="display: flex; flex-wrap: wrap; gap: 5px;">
                        <span onclick="sendChatEmoji('üòÄ')" style="cursor: pointer; font-size: 20px;">üòÄ</span>
                        <span onclick="sendChatEmoji('üòÇ')" style="cursor: pointer; font-size: 20px;">üòÇ</span>
                        <span onclick="sendChatEmoji('üòç')" style="cursor: pointer; font-size: 20px;">üòç</span>
                        <span onclick="sendChatEmoji('ü§î')" style="cursor: pointer; font-size: 20px;">ü§î</span>
                        <span onclick="sendChatEmoji('üëç')" style="cursor: pointer; font-size: 20px;">üëç</span>
                        <span onclick="sendChatEmoji('üëé')" style="cursor: pointer; font-size: 20px;">üëé</span>
                        <span onclick="sendChatEmoji('‚ù§Ô∏è')" style="cursor: pointer; font-size: 20px;">‚ù§Ô∏è</span>
                        <span onclick="sendChatEmoji('üéâ')" style="cursor: pointer; font-size: 20px;">üéâ</span>
                    </div>
                </div>
                
                <!-- –ü–∞–Ω–µ–ª—å –≤–≤–æ–¥–∞ -->
                <div style="padding: 15px; border-top: 1px solid #ddd; background: white; border-radius: 0 0 15px 15px;">
                    <div style="display: flex; gap: 10px;">
                        <button onclick="toggleEmojiPanel()" style="background: #ff9800; color: white; border: none; padding: 8px 12px; border-radius: 5px; cursor: pointer;">üòÄ</button>
                        <input type="text" id="messageInput" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..." style="flex: 1; padding: 10px; border: 1px solid #ddd; border-radius: 5px;" onkeypress="handleMessageKeyPress(event)" autocomplete="off">
                        <button onclick="sendMessage()" style="background: #4CAF50; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                    </div>
                </div>
            </div>
        </div>
            
        <!-- –°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π -->
        <div class="user-section friends-section friends-management" id="friendsSection">
            <h2><i class="fas fa-users"></i> –°–∏—Å—Ç–µ–º–∞ –¥—Ä—É–∑–µ–π</h2>
            
            <!-- –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <div class="search-section">
                <h3><i class="fas fa-search"></i> –ü–æ–∏—Å–∫ –ø–æ –Ω–æ–º–µ—Ä—É —Ç–µ–ª–µ—Ñ–æ–Ω–∞</h3>
                <input type="text" id="searchUsername" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (+79991234567)" style="width: 300px;" autocomplete="new-password" autocapitalize="off" autocorrect="off" spellcheck="false" readonly onfocus="this.removeAttribute('readonly')">
                <button onclick="searchUser()" class="btn-primary"><i class="fas fa-search"></i> –ù–∞–π—Ç–∏</button>
                <div id="searchResults" class="search-results"></div>
        </div>
            
            <!-- –°–ø–∏—Å–∫–∏ -->
            <div style="display: flex; gap: 20px; flex-wrap: wrap;">
                <!-- –î—Ä—É–∑—å—è -->
                <div style="flex: 1; min-width: 250px;">
                    <h3><i class="fas fa-users"></i> –î—Ä—É–∑—å—è</h3>
                    <div id="friendsList" class="friends-list">
                        <p style="color: #666; text-align: center; margin: 20px 0;">–ù–µ—Ç –¥—Ä—É–∑–µ–π</p>
                </div>
        </div>
            
                <!-- –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è -->
                <div style="flex: 1; min-width: 250px;">
                    <h3>üì® –ó–∞–ø—Ä–æ—Å—ã –≤ –¥—Ä—É–∑—å—è</h3>
                    <div id="requestsList" class="requests-list">
                        <p style="color: #666; text-align: center; margin: 20px 0;">–ù–µ—Ç –∑–∞–ø—Ä–æ—Å–æ–≤</p>
                </div>
            </div>
            
                <!-- –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è -->
                <div style="flex: 1; min-width: 250px;">
                    <h3><i class="fas fa-paper-plane"></i> –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è</h3>
                    <div id="sentRequestsList" class="sent-requests-list">
                        <p style="color: #666; text-align: center; margin: 20px 0;">–ù–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π</p>
                </div>
        </div>
        </div>
        
        <div class="user-section logs-section system-logs">
            <h2>üìã –õ–æ–≥–∏</h2>
            <button onclick="copyLogs()" style="background: #4CAF50; color: white; font-weight: bold;">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–∏</button>
            <p>–≠—Ç–∞ –∫–Ω–æ–ø–∫–∞ —Å–∫–æ–ø–∏—Ä—É–µ—Ç –ª–æ–≥–∏ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É</p>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤–Ω–µ—à–Ω–∏—Ö JavaScript —Ñ–∞–π–ª–æ–≤ -->
    <script src="del.js?v=1"></script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('load', function() {
            const userData = localStorage.getItem('userData');
            if (!userData) {
                // –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                window.location.href = 'login.php';
                return;
            }
            
            try {
                const user = JSON.parse(userData);
                if (!user.username || !user.sessionToken) {
                    // –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–µ–ø–æ–ª–Ω—ã–µ, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                    localStorage.removeItem('userData');
                    window.location.href = 'login.php';
                    return;
                }
            } catch (error) {
                // –û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:', error);
                localStorage.removeItem('userData');
                window.location.href = 'login.php';
                return;
            }
        });
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞ - –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
        function logout() {
            // –û—á–∏—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            localStorage.removeItem('userData');
            
            // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
            window.location.href = 'login.php';
        }
        
        function openProfile() {
            // –û—Ç–∫—Ä—ã–≤–∞–µ–º –ª–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç –≤ —Ç–æ–º –∂–µ –æ–∫–Ω–µ
            window.location.href = 'profile.php';
        }
        
    </script>
    
    <script>
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–ª–µ–π –ø–æ–∏—Å–∫–∞
        document.addEventListener('DOMContentLoaded', function() {
            const searchInputs = document.querySelectorAll('#searchUsername');
            searchInputs.forEach(input => {
                // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞—Ç—Ä–∏–±—É—Ç—ã
                input.setAttribute('autocomplete', 'new-password');
                input.setAttribute('autocapitalize', 'off');
                input.setAttribute('autocorrect', 'off');
                input.setAttribute('spellcheck', 'false');
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
                input.value = '';
                
                // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –æ—Ç–∫–ª—é—á–µ–Ω–∏—è
                input.addEventListener('focus', function() {
                    this.setAttribute('autocomplete', 'new-password');
                    this.value = '';
                });
                
                input.addEventListener('input', function() {
                    this.setAttribute('autocomplete', 'new-password');
                });
                
                // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ñ–æ–∫—É—Å–µ
                input.addEventListener('focus', function() {
                    setTimeout(() => {
                        if (this.value && !this.value.startsWith('+')) {
                            this.value = '';
                        }
                    }, 100);
                });
                
                // –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ–º –≤—Å—Ç–∞–≤–∫—É –∏–∑ –±—É—Ñ–µ—Ä–∞ –∞–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è
                input.addEventListener('paste', function(e) {
                    e.preventDefault();
                    const text = (e.clipboardData || window.clipboardData).getData('text');
                    if (text && text.startsWith('+')) {
                        this.value = text;
                    }
                });
            });
        });
    </script>
    
    <script src="app.js?v=5"></script>
    <script src="js/contacts-handler.js"></script>
    
    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function loadUserAvatar() {
            const userData = localStorage.getItem('userData');
            if (!userData) return;

            try {
                const data = JSON.parse(userData);
                const userId = data.userId;
                
                if (!userId) return;

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
                fetch(`avtr/api/get_user_data.php?user_id=${userId}`)
                    .then(response => response.json())
                    .then(result => {
                        const userAvatar = document.getElementById('userAvatar');
                        if (result.success && result.user.avatar_path) {
                            userAvatar.innerHTML = `<img src="${result.user.avatar_path}" alt="–ê–≤–∞—Ç–∞—Ä" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">`;
                        } else {
                            userAvatar.innerHTML = '<i class="fas fa-user-circle"></i>';
                        }
                    })
                    .catch(error => {
                        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∞–≤–∞—Ç–∞—Ä–∞:', error);
                    });
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞ userData:', error);
            }
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–æ–≤–æ–≥–æ
        function updateAvatarAfterUpload(avatarPath) {
            const userAvatar = document.getElementById('userAvatar');
            if (avatarPath) {
                userAvatar.innerHTML = `<img src="${avatarPath}" alt="–ê–≤–∞—Ç–∞—Ä" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover;">`;
            } else {
                userAvatar.innerHTML = '<i class="fas fa-user-circle"></i>';
            }
        }


        // –î–µ–ª–∞–µ–º —Ñ—É–Ω–∫—Ü–∏—é –≥–ª–æ–±–∞–ª—å–Ω–æ–π
        window.updateAvatarAfterUpload = updateAvatarAfterUpload;

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–∫–∞–∑–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
        function showNotification(message, type = 'info') {
            // –£–¥–∞–ª—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            const existingNotifications = document.querySelectorAll('.custom-notification');
            existingNotifications.forEach(notification => notification.remove());
            
            // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = 'custom-notification';
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#17a2b8'};
                color: white;
                padding: 12px 20px;
                border-radius: 5px;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
                z-index: 10000;
                max-width: 400px;
                min-width: 300px;
                font-size: 14px;
                animation: slideIn 0.3s ease-out;
            `;
            
            notification.innerHTML = `
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <span>${message}</span>
                    <button onclick="this.parentElement.parentElement.remove()" style="background: none; border: none; color: white; font-size: 18px; cursor: pointer; margin-left: 10px;">&times;</button>
                </div>
            `;
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
            `;
            document.head.appendChild(style);
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫—Ä—ã–≤–∞–µ–º —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.remove();
                }
            }, 5000);
        }

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –∏–∑ –∑–∞–ø–∏—Å–Ω–æ–π –∫–Ω–∏–∂–∫–∏
        async function selectFromContacts() {
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–¥–µ—Ä–∂–∫—É Contacts API
            if (!('contacts' in navigator)) {
                showNotification('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –≤—Ä—É—á–Ω—É—é.', 'error');
                return;
            }

            try {
                // –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–∞ –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º
                const contacts = await navigator.contacts.select(['name', 'tel'], { multiple: false });
                
                if (contacts && contacts.length > 0) {
                    const contact = contacts[0];
                    const phoneNumber = contact.tel && contact.tel.length > 0 ? contact.tel[0] : null;
                    
                    if (phoneNumber) {
                        // –û—á–∏—â–∞–µ–º –Ω–æ–º–µ—Ä –æ—Ç –ª–∏—à–Ω–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º
                        let cleanNumber = phoneNumber.replace(/[^\d+]/g, '');
                        
                        // –ï—Å–ª–∏ –Ω–æ–º–µ—Ä –Ω–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å +, –¥–æ–±–∞–≤–ª—è–µ–º +7 –¥–ª—è —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö –Ω–æ–º–µ—Ä–æ–≤
                        if (!cleanNumber.startsWith('+')) {
                            if (cleanNumber.startsWith('8')) {
                                cleanNumber = '+7' + cleanNumber.substring(1);
                            } else if (cleanNumber.startsWith('7')) {
                                cleanNumber = '+' + cleanNumber;
                            } else {
                                cleanNumber = '+7' + cleanNumber;
                            }
                        }
                        
                        // –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–º–µ—Ä –≤ –ø–æ–ª–µ –ø–æ–∏—Å–∫–∞
                        document.getElementById('searchUsername').value = cleanNumber;
                        
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–º—è –∫–æ–Ω—Ç–∞–∫—Ç–∞ –≤ IndexedDB
                        if (contact.name) {
                            try {
                                await saveContactName(cleanNumber, contact.name);
                                showNotification('–ù–æ–º–µ—Ä –≤—ã–±—Ä–∞–Ω –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤: ' + contact.name, 'success');
                            } catch (error) {
                                console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–º–µ–Ω–∏ –∫–æ–Ω—Ç–∞–∫—Ç–∞:', error);
                                showNotification('–ù–æ–º–µ—Ä –≤—ã–±—Ä–∞–Ω: ' + contact.name, 'success');
                            }
                        } else {
                            showNotification('–ù–æ–º–µ—Ä –≤—ã–±—Ä–∞–Ω –∏–∑ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤', 'success');
                        }
                    } else {
                        showNotification('–£ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ –Ω–µ—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.', 'error');
                    }
                }
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞:', error);
                if (error.name === 'NotAllowedError') {
                    showNotification('–î–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º –∑–∞–ø—Ä–µ—â–µ–Ω. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Ä–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞.', 'error');
                } else if (error.name === 'NotSupportedError') {
                    showNotification('–í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞–º.', 'error');
                } else {
                    showNotification('–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞: ' + error.message, 'error');
                }
            }
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–≤–∞—Ç–∞—Ä –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(loadUserAvatar, 1000); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        });
    </script>
</body>
</html>

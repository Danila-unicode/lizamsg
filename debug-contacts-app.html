<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug contacts-app.html</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .debug-section {
            background: #f5f5f5;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .log {
            background: #000;
            color: #0f0;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            max-height: 300px;
            overflow-y: auto;
        }
    </style>
</head>
<body>
    <h1>üêõ Debug contacts-app.html</h1>
    
    <div class="debug-section">
        <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ—É–Ω–∫—Ü–∏–π</h2>
        <button class="test-button" onclick="testFunction('searchUser')">üîç searchUser</button>
        <button class="test-button" onclick="testFunction('loadContacts')">üë• loadContacts</button>
        <button class="test-button" onclick="testFunction('showTab')">üìë showTab</button>
        <button class="test-button" onclick="testFunction('callContact')">üìû callContact</button>
        <button class="test-button" onclick="testFunction('endCall')">üì¥ endCall</button>
        <button class="test-button" onclick="testFunction('logout')">üö™ logout</button>
    </div>
    
    <div class="debug-section">
        <h2>–ü—Ä–æ–≤–µ—Ä–∫–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</h2>
        <button class="test-button" onclick="checkElements()">üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã</button>
        <button class="test-button" onclick="checkAuth()">üîë –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é</button>
    </div>
    
    <div class="debug-section">
        <h2>–õ–æ–≥ –æ—Ç–ª–∞–¥–∫–∏</h2>
        <div id="debugLog" class="log">–ì–æ—Ç–æ–≤ –∫ –æ—Ç–ª–∞–¥–∫–µ...\n</div>
    </div>
    
    <div class="debug-section">
        <h2>–ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Å–Ω–æ–≤–Ω–æ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é</h2>
        <a href="contacts-app.html" class="test-button" style="text-decoration: none; display: inline-block;">üöÄ –û—Ç–∫—Ä—ã—Ç—å contacts-app.html</a>
    </div>

    <script>
        function log(message) {
            const logElement = document.getElementById('debugLog');
            const time = new Date().toLocaleTimeString();
            logElement.textContent += `[${time}] ${message}\n`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function testFunction(funcName) {
            log(`üß™ –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é: ${funcName}`);
            
            if (typeof window[funcName] === 'function') {
                log(`‚úÖ –§—É–Ω–∫—Ü–∏—è ${funcName} –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞`);
                try {
                    if (funcName === 'showTab') {
                        window[funcName]('contacts');
                    } else if (funcName === 'callContact') {
                        window[funcName](12, '+79182725363');
                    } else {
                        window[funcName]();
                    }
                    log(`‚úÖ –§—É–Ω–∫—Ü–∏—è ${funcName} –≤—ã–∑–≤–∞–Ω–∞ —É—Å–ø–µ—à–Ω–æ`);
                } catch (error) {
                    log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ ${funcName}: ${error.message}`);
                }
            } else {
                log(`‚ùå –§—É–Ω–∫—Ü–∏—è ${funcName} –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞`);
            }
        }

        function checkElements() {
            log('üîç –ü—Ä–æ–≤–µ—Ä—è–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã DOM...');
            
            const elements = [
                'searchPhone',
                'searchResults', 
                'contactsList',
                'requestsList',
                'rejectedList',
                'localVideo',
                'remoteVideo',
                'endCallBtn',
                'connectionStatus',
                'userInfo'
            ];
            
            elements.forEach(elementId => {
                const element = document.getElementById(elementId);
                if (element) {
                    log(`‚úÖ –≠–ª–µ–º–µ–Ω—Ç ${elementId} –Ω–∞–π–¥–µ–Ω`);
                } else {
                    log(`‚ùå –≠–ª–µ–º–µ–Ω—Ç ${elementId} –Ω–µ –Ω–∞–π–¥–µ–Ω`);
                }
            });
        }

        async function checkAuth() {
            log('üîë –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é...');
            try {
                const response = await fetch('api/check_auth.php');
                const data = await response.json();
                log(`–†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${JSON.stringify(data)}`);
                
                if (data.success) {
                    log('‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
                } else {
                    log('‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω');
                }
            } catch (error) {
                log(`‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏: ${error.message}`);
            }
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.addEventListener('load', function() {
            log('üöÄ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –æ—Ç–ª–∞–¥–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω–∞');
            log('–ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ñ—É–Ω–∫—Ü–∏–π...');
            
            const functions = ['searchUser', 'loadContacts', 'showTab', 'callContact', 'endCall', 'logout'];
            functions.forEach(funcName => {
                if (typeof window[funcName] === 'function') {
                    log(`‚úÖ ${funcName} –¥–æ—Å—Ç—É–ø–Ω–∞`);
                } else {
                    log(`‚ùå ${funcName} –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞`);
                }
            });
        });
    </script>
</body>
</html>
